University: ITMO University

Faculty: FICT

Course: Network programming

Year: 2022

Group: K34202

Author: Trieu Minh Tam

Lab: Lab3

Date of create: 30.10.2022

Ход работы:

1. Поднимаем Ubuntu 20.04 на виртуальной машине на хосте. Она будет предназначена для NetBox. Соединяем её с виртуальной машиной в облаке Яндекса, используя Wireguard по аналогии с первой лабораторной работой. Проверяем, что связь есть (192.168.6.1 - IP адрес виртуальной машины в Яндексе)
![image](https://user-images.githubusercontent.com/87965299/198852657-ec74dc4c-5ef1-407c-864f-f80b678bf1b4.png)

2. Запускаем Netbox. Это требует установки большого количества зависимостей. Далее первый этап - это установка и настройка postgresql. Создаем базу данных Netbox с одноимённым пользователем, запускаем. Проверяем, что всё работает корректно.
![image](https://user-images.githubusercontent.com/87965299/198852960-03eb2787-8265-49a6-9a58-975e0c62e737.png)
![image](https://user-images.githubusercontent.com/87965299/198854387-ae15717f-3fc4-4ecb-8134-5f967a8805a8.png)

3. Устанавливаем redis-server.
![image](https://user-images.githubusercontent.com/87965299/198854480-7ff27b90-a5d7-46e3-8fa5-e4e3e5c1e724.png)

4. Конгиругация netbox.
![image](https://user-images.githubusercontent.com/87965299/198855116-32b7e962-40b0-4c6e-98a6-cc589416639c.png)

5. Создан суперпользователь и запущен сервер Netbox для тестирования.
![image](https://user-images.githubusercontent.com/87965299/198855373-5b73b0d3-85ba-47bb-82aa-9793fe9d32e7.png)

6. Далее в браузере открываем ссылку на netbox и видим главную страницу.
![image](https://user-images.githubusercontent.com/87965299/198855603-add1b14b-43f2-4e68-9a19-15b3e4faf865.png)

7. Проверяем работу Netbox
![image](https://user-images.githubusercontent.com/87965299/198855839-480a5fa4-adb6-4343-96b5-370a50888a8a.png)

8. Изначально там нет никакой информации, мы вносим два наших роутера. В моём случае занесены Сайт и сопутствующая информация для того, чтобы можно было добавить роутер.
![image](https://user-images.githubusercontent.com/87965299/203049005-2dcd4af3-3ddb-49e6-ab51-f6754015b2ea.png)

9.Далее вносим роутеры и информацию о них. На скриншоте также присутствует IP адрес, но по факту он будет внесён позднее.
![image](https://user-images.githubusercontent.com/87965299/203049799-f7279921-6fe0-42eb-abcf-4ead9dd523b2.png)

10.Для внесения IP адреса требуется создать интерфейс на роутере. Таким образом, в Netbox записаны два роутера, их ID, названияи, нтерфейсы и IP адреса.
![image](https://user-images.githubusercontent.com/87965299/203050352-00e19f47-6180-4d46-9538-fde1d6aa13b8.png)

11. Начинаем работу над плейбуком. В папке он представлен в итоговом виде. Первая - спарсить csv файл и записать нужную нам информацию о роутере в отдельный файл. В данном случае за ключ берём UID роутера, так как это значение не будет изменяться.
![image](https://user-images.githubusercontent.com/87965299/203050889-b1b0567b-47d9-478c-8104-f2400165c803.png)

12. Запускаем, чтобы проверить правильность вывода.
![image](https://user-images.githubusercontent.com/87965299/203051023-20a72560-7b2f-4659-a690-9e156334f646.png)

13. Теперь дописываем часть, связанную с установкой названия роутера.
![image](https://user-images.githubusercontent.com/87965299/203051794-2946e196-8d51-499b-adfa-c8c4cec04df0.png)

14. И запускаем весь плейбук целиком, в результате чего он берёт имя роутера из csv файла, сгенерированного Netbox, и присваивает это имя подключенному роутеру. Вывод результатов показывает, что всё работает корректно.
![image](https://user-images.githubusercontent.com/87965299/203051955-1119487c-fbcd-4a98-a4b4-6427e0ad08a1.png)

15. В консоли Микротика видим, что имя роутера изменилось.
![image](https://user-images.githubusercontent.com/87965299/203052091-04979f97-2ce6-47b3-991f-3c7abf9fa720.png)

16. Далее реализуем ту часть задания, в которой информация достаётся из Микротика и передаётся в файл на виртуальной машине в облаке.
![image](https://user-images.githubusercontent.com/87965299/203056267-da94149f-fd40-4d5f-902e-e6d038d5195d.png)

17. И теперь вносим эту информацию в Netbox. В моём случае создаётся девайс, в котором часть настроек предопределено, а имя используется то, которое было взято из Микротика.
![image](https://user-images.githubusercontent.com/87965299/203056341-c0ea901a-ac1e-46d8-90f1-4bae373ffa49.png)

18. Запускаем итоговый файл, видим корректный вывод от ansible.
![image](https://user-images.githubusercontent.com/87965299/203056425-8ac8539f-a2f3-4e62-abbf-4ba03b117f3e.png)

Выводы: Мы познакомились с довольно интересным и очень гибким инструментом для документирования сетей - Netbox. Также узнали, насколько многофункционален ansible, так как с его помощью можно довольно просто решать сложные и долгие задачи, автоматизируя весь процесс.
